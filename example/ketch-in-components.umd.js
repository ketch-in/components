(function(i,a){typeof exports=="object"&&typeof module!="undefined"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(i=typeof globalThis!="undefined"?globalThis:i||self,a(i.ketchInComponents={}))})(this,function(i){"use strict";var N=Object.defineProperty,R=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var g=(i,a,h)=>a in i?N(i,a,{enumerable:!0,configurable:!0,writable:!0,value:h}):i[a]=h,E=(i,a)=>{for(var h in a||(a={}))U.call(a,h)&&g(i,h,a[h]);if(D)for(var h of D(a))j.call(a,h)&&g(i,h,a[h]);return i},y=(i,a)=>R(i,I(a));var l=(i,a,h)=>(g(i,typeof a!="symbol"?a+"":a,h),h);var a="";const h={removeDelay:2e3};class p{constructor(e,t,n=!1){l(this,"target");l(this,"options");this.target=e,this.options=t||{},!n&&this.clear()}getOption(e){return this.options[e]||h[e]}clear(){this.target.innerText=""}}const v="ketch-in-components";function L(m,e){const t=document.createElement(m,e);return t.className=v,t}class C{constructor({data:e,defaultClassName:t,removeDelay:n=2e3}){l(this,"data");l(this,"state");l(this,"element");l(this,"defaultClassName");l(this,"removeDelay");this.data=e,this.state="unmount",this.defaultClassName=t||"",this.removeDelay=n,this.element=this.createElement("div")}setRemoveDelay(e){return this.removeDelay=e,this}getRemoveDelay(){return this.removeDelay}createElement(e,t){const n=L(e,t);return n.classList.add(this.defaultClassName),n}getData(){return this.data}setState(e){return this.state=e,this.isUnmounting()?this.element.classList.add("unmount"):this.element.classList.remove("unmount"),this}getState(){return this.state}getElement(){return this.element}isMount(){return this.getState()==="mount"}isUnmount(){return this.getState()==="unmount"}isUnmounting(){return this.getState()==="unmounting"}async clear(){return this.isUnmount()||await this.unmount(),this.element=this.createElement("div"),this}async mount(e){return this.isMount()&&await this.unmount(),e.append(this.element),this.setState("mount")}unmount(){return new Promise(e=>{if(!this.isMount()){const t=setInterval(()=>{if(this.isUnmount())return clearInterval(t),e(this)},1e3)}this.setState("unmounting"),setTimeout(()=>{this.element.parentElement&&this.element.parentElement.removeChild(this.element),this.setState("unmount").clear().then(()=>e(this))},this.getRemoveDelay())})}}class b extends C{constructor({children:t,removeDelay:n,data:s={},onClose:o=()=>{}}){super({data:s,removeDelay:n,defaultClassName:"modal"});l(this,"children");l(this,"onClose");this.children=t,this.onClose=()=>o(this)}mount(t){const n=this.getElement(),s=this.createElement("div");s.append(this.children),s.classList.add("body"),n.appendChild(s);const o=this.createElement("span");return o.innerText="\uB2EB\uAE30",o.classList.add("close"),o.onclick=()=>{o.onclick=()=>{},this.unmount().then(this.onClose)},n.appendChild(o),super.mount(t)}}class S extends p{constructor(e,t){super(e,t)}add(e){return new b(y(E({},e),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class F extends C{constructor({children:t,buttons:n,removeDelay:s,data:o={},onClick:r=()=>{}}){super({data:o,removeDelay:s,defaultClassName:"select-modal"});l(this,"children");l(this,"buttons");l(this,"onClick");this.children=t,this.buttons=n,this.onClick=(c,u,d)=>(r(c,u,d),this)}click(t){return super.unmount().then(()=>this.onClick(this,t,this.buttons[t]))}mount(t){const n=this.getElement(),s=this.createElement("div");return s.append(this.children),s.classList.add("body"),n.appendChild(s),Object.keys(this.buttons).map(o=>{const r=this.createElement("button");r.classList.add("btn"),r.innerText=this.buttons[o],r.onclick=()=>{r.onclick=()=>{},this.click(o)},n.append(r)}),super.mount(t)}}class k extends p{constructor(e,t){super(e,t)}add(e){return new F(y(E({},e),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class x extends C{constructor({data:t,removeDelay:n,defaultClassName:s,momentDelay:o=2e3}){super({data:t,removeDelay:n,defaultClassName:s});l(this,"momentDelay");l(this,"momentTimeout");this.momentDelay=o,this.momentTimeout=null}setMomentTimeout(t){return this.momentTimeout=t,this}async mount(t){return super.mount(t).then(()=>this.setMomentTimeout(setTimeout(()=>this.unmount(),this.momentDelay)))}unmount(){return this.momentTimeout&&(clearTimeout(this.momentTimeout),this.setMomentTimeout(null)),super.unmount()}}class M extends x{constructor({children:t,data:n={},removeDelay:s=2e3,momentDelay:o=2e3,onClick:r=()=>{},onClose:c=()=>{}}){super({removeDelay:s,momentDelay:o,data:n,defaultClassName:"toast"});l(this,"children");l(this,"onClick");l(this,"onClose");this.children=t,this.onClick=r,this.onClose=u=>c(this,u)}mount(t){const n=this.getElement(),s=this.createElement("div"),o=this.createElement("span");return s.append(this.children),o.innerText="\uB2EB\uAE30",s.classList.add("text"),o.classList.add("close"),n.appendChild(s),n.appendChild(o),n.onclick=r=>{n.onclick=()=>{},!r.composedPath().some(c=>c===o)&&this.unmount(!0).then(this.onClick)},o.onclick=()=>{o.onclick=()=>{},this.unmount(!0)},super.mount(t)}unmount(t=!1){if(this.isMount()){const n=this.onClose(t),s=!!n||n===0?n:this.getRemoveDelay();this.setRemoveDelay(s)}return super.unmount()}}class B extends p{constructor(e,t){super(e,t)}add(e){return new M(y(E({},e),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}const _=["#000000","#262626","#363636","#555555","#737373","#999999","#B2B2B2","#C7C7C7","#DBDBDB","#EFEFEF","#FFFFFF","#EF848C","#FFDEDE","#FFE3C7","#FFC47B","#CEF3FB","#A3DED0","#EE4753","#FF8C1C","#FFCC51","#70C050","#174A28","#3897F0","#1AA39C","#89C4F4","#1C8BC3","#004E82","#684172","#9B6336","#003960","#1E3993","#5300D2","#740060","#4F0041","#432223"];class T extends C{constructor({removeDelay:t,onColorSelect:n=()=>{}}){super({removeDelay:t,defaultClassName:"toolbar__color-palette"});l(this,"onColorSelect");this.onColorSelect=n}mount(t){var r;const n=this.getElement(),s=this.createElement("div"),o=this.createElement("ul");return _.map(c=>{const u=this.createElement("li"),d=this.createElement("div");d.innerText=`[${c}]`,d.dataset.color=c,u.classList.add(`btn-${c}`),u.appendChild(d),o.appendChild(u)}),s.classList.add("wrapper"),s.appendChild(o),n.appendChild(s),o.onclick=c=>{const u=c.target;if(u.closest("li")){const d=u.dataset.color;d&&this.onColorSelect(d)}},(r=document.querySelector(".toolbar"))==null||r.addEventListener("click",c=>{c.target.contains(n)||this.unmount().then(this.closeLayer)}),super.mount(t)}unMount(){this.unmount()}closeLayer(){document.body.onclick=null}}class O extends p{constructor(t,n){super(t,n,!0);l(this,"layer")}add(t){if(this.layer=new T(y(E({},t),{removeDelay:0})),this.layer instanceof T)return this.layer.mount(this.target)}close(){if(this.layer instanceof T)return this.layer.unMount()}}class P extends C{constructor({data:t={},status:n="",handlePen:s=()=>{},handleShape:o=()=>{},handleColor:r=()=>{},onClear:c=()=>{}}){super({data:t,defaultClassName:"toolbar"});l(this,"status");l(this,"handlePen");l(this,"handleShape");l(this,"handleColor");l(this,"onClear");this.status=n,this.handlePen=s,this.handleShape=o,this.handleColor=r,this.onClear=c}mount(t){const n=this.getElement(),s=this.createElement("div"),o=this.createElement("span"),r=this.createElement("button"),c=this.createElement("button"),u=this.createElement("span"),d=this.createElement("button");s.classList.add("wrapper"),o.innerText=`[${this.status}]`,o.classList.add("status"),r.innerText="PEN",r.classList.add("btn_pen"),c.innerText="SHAPE_COMP",c.classList.add("select_shape"),u.classList.add("palette"),u.innerText="[PALETTE]",d.innerText="CLEAR_ALL",d.classList.add("btn_clear"),s.appendChild(o),s.appendChild(r),s.appendChild(c),s.appendChild(u),s.appendChild(d),n.appendChild(s),r.onclick=this.handlePen,c.onclick=this.handleShape;const f=new O(u,{});return u.onclick=()=>{u.children.length?f.close():f.add({onColorSelect:w=>this.handleColor(w)})},d.onclick=this.onClear,super.mount(t)}}class A extends p{constructor(e,t){super(e,t)}add(e){return new P(e).mount(this.target)}}i.ModalController=S,i.SelectModalController=k,i.ToastController=B,i.ToolbarController=A,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
