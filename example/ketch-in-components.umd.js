(function(c,u){typeof exports=="object"&&typeof module!="undefined"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(c=typeof globalThis!="undefined"?globalThis:c||self,u(c.ketchInComponents={}))})(this,function(c){"use strict";var H=Object.defineProperty,j=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var T=(c,u,d)=>u in c?H(c,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):c[u]=d,E=(c,u)=>{for(var d in u||(u={}))V.call(u,d)&&T(c,d,u[d]);if(v)for(var d of v(u))$.call(u,d)&&T(c,d,u[d]);return c},y=(c,u)=>j(c,G(u));var a=(c,u,d)=>(T(c,typeof u!="symbol"?u+"":u,d),d);var u="";const d={removeDelay:2e3};class p{constructor(n,t,e=!1){a(this,"target");a(this,"options");this.target=n,this.options=t||{},!e&&this.clear()}getOption(n){return this.options[n]||d[n]}clear(){this.target.innerText=""}}const k="ketch-in-components";function x(h,n){const t=document.createElement(h,n);return t.className=k,t}class C{constructor({data:n,defaultClassName:t,removeDelay:e=2e3}){a(this,"data");a(this,"state");a(this,"element");a(this,"defaultClassName");a(this,"removeDelay");this.data=n,this.state="unmount",this.defaultClassName=t||"",this.removeDelay=e,this.element=this.createElement("div")}setRemoveDelay(n){return this.removeDelay=n,this}getRemoveDelay(){return this.removeDelay}createElement(n,t){const e=x(n,t);return e.classList.add(this.defaultClassName),e}createSVGElement(n,t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");return s.setAttribute("width",n.toString()),s.setAttribute("height",t.toString()),s.classList.add(this.defaultClassName),s}getData(){return this.data}setState(n){return this.state=n,this.isUnmounting()?this.element.classList.add("unmount"):this.element.classList.remove("unmount"),this}getState(){return this.state}getElement(){return this.element}isMount(){return this.getState()==="mount"}isUnmount(){return this.getState()==="unmount"}isUnmounting(){return this.getState()==="unmounting"}async clear(){return this.isUnmount()||await this.unmount(),this.element=this.createElement("div"),this}async mount(n){return this.isMount()&&await this.unmount(),n.append(this.element),this.setState("mount")}unmount(){return new Promise(n=>{if(!this.isMount()){const t=setInterval(()=>{if(this.isUnmount())return clearInterval(t),n(this)},1e3)}this.setState("unmounting"),setTimeout(()=>{this.element.parentElement&&this.element.parentElement.removeChild(this.element),this.setState("unmount").clear().then(()=>n(this))},this.getRemoveDelay())})}}class F extends C{constructor({children:t,removeDelay:e,data:s={},onClose:o=()=>{}}){super({data:s,removeDelay:e,defaultClassName:"modal"});a(this,"children");a(this,"onClose");this.children=t,this.onClose=()=>o(this)}mount(t){const e=this.getElement(),s=this.createElement("div");s.append(this.children),s.classList.add("body"),e.appendChild(s);const o=this.createElement("span");return o.innerText="\uB2EB\uAE30",o.classList.add("close"),o.onclick=()=>{o.onclick=()=>{},this.unmount().then(this.onClose)},e.appendChild(o),super.mount(t)}}class w extends p{constructor(n,t){super(n,t)}add(n){return new F(y(E({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class M extends C{constructor({children:t,buttons:e,removeDelay:s,data:o={},onClick:l=()=>{}}){super({data:o,removeDelay:s,defaultClassName:"select-modal"});a(this,"children");a(this,"buttons");a(this,"onClick");this.children=t,this.buttons=e,this.onClick=(i,r,m)=>(l(i,r,m),this)}click(t){return super.unmount().then(()=>this.onClick(this,t,this.buttons[t]))}mount(t){const e=this.getElement(),s=this.createElement("div");return s.append(this.children),s.classList.add("body"),e.appendChild(s),Object.keys(this.buttons).map(o=>{const l=this.createElement("button");l.classList.add("btn"),l.innerText=this.buttons[o],l.onclick=()=>{l.onclick=()=>{},this.click(o)},e.append(l)}),super.mount(t)}}class _ extends p{constructor(n,t){super(n,t)}add(n){return new M(y(E({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class A extends C{constructor({data:t,removeDelay:e,defaultClassName:s,momentDelay:o=2e3}){super({data:t,removeDelay:e,defaultClassName:s});a(this,"momentDelay");a(this,"momentTimeout");this.momentDelay=o,this.momentTimeout=null}setMomentTimeout(t){return this.momentTimeout=t,this}async mount(t){return super.mount(t).then(()=>this.setMomentTimeout(setTimeout(()=>this.unmount(),this.momentDelay)))}unmount(){return this.momentTimeout&&(clearTimeout(this.momentTimeout),this.setMomentTimeout(null)),super.unmount()}}class B extends A{constructor({children:t,data:e={},removeDelay:s=2e3,momentDelay:o=2e3,onClick:l=()=>{},onClose:i=()=>{}}){super({removeDelay:s,momentDelay:o,data:e,defaultClassName:"toast"});a(this,"children");a(this,"onClick");a(this,"onClose");this.children=t,this.onClick=l,this.onClose=r=>i(this,r)}mount(t){const e=this.getElement(),s=this.createElement("div"),o=this.createElement("span");return s.append(this.children),o.innerText="\uB2EB\uAE30",s.classList.add("text"),o.classList.add("close"),e.appendChild(s),e.appendChild(o),e.onclick=l=>{e.onclick=()=>{},!l.composedPath().some(i=>i===o)&&this.unmount(!0).then(this.onClick)},o.onclick=()=>{o.onclick=()=>{},this.unmount(!0)},super.mount(t)}unmount(t=!1){if(this.isMount()){const e=this.onClose(t),s=!!e||e===0?e:this.getRemoveDelay();this.setRemoveDelay(s)}return super.unmount()}}class O extends p{constructor(n,t){super(n,t)}add(n){return new B(y(E({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}const P=["#000000","#262626","#363636","#555555","#737373","#999999","#B2B2B2","#C7C7C7","#DBDBDB","#EFEFEF","#FFFFFF","#EF848C","#FFDEDE","#FFE3C7","#FFC47B","#CEF3FB","#A3DED0","#EE4753","#FF8C1C","#FFCC51","#70C050","#174A28","#3897F0","#1AA39C","#89C4F4","#1C8BC3","#004E82","#684172","#9B6336","#003960","#1E3993","#5300D2","#740060","#4F0041","#432223"];class g extends C{constructor({removeDelay:t,onColorSelect:e=()=>{}}){super({removeDelay:t,defaultClassName:"toolbar__color-palette"});a(this,"onColorSelect");this.onColorSelect=e}mount(t){var o;const e=this.getElement(),s=this.createElement("ul");return P.map(l=>{const i=this.createElement("li"),r=this.createElement("label");r.style.width="27px",r.style.height="27px",r.style.display="inline-block",r.classList.add("color-unit"),r.dataset.color=l,r.style.backgroundColor=l,i.classList.add(`btn-${l}`),i.appendChild(r),s.appendChild(i)}),s.classList.add("wrapper"),e.appendChild(s),s.onclick=l=>{const i=l.target;if(i.closest("li")){const r=i.dataset.color;r&&this.onColorSelect(r)}},(o=document.querySelector(".toolbar"))==null||o.addEventListener("click",l=>{l.target.contains(e)||this.unmount().then(this.onClose)}),super.mount(t)}unMount(){this.unmount()}onClose(){document.body.onclick=null}}class N extends p{constructor(t,e){super(t,e,!0);a(this,"layer")}open(t){if(this.layer=new g(y(E({},t),{removeDelay:0})),this.layer instanceof g)return this.layer.mount(this.target)}close(){if(this.layer instanceof g)return this.layer.unMount()}}const L={rect:"<rect x='5' y='5' width='10' height='10' fill='none' stroke='grey' />",["rounded-rect"]:"<rect x='5' y='5' rx='2' width='10' height='10' fill='none' stroke='grey' />",circle:"<circle cx='10' cy='10' r='5' fill='none' stroke='grey' />",triangle:"<ellipse cx='10' cy='10' rx='6' ry = '4' fill='none' stroke='grey' />"};class f extends C{constructor({removeDelay:t,onShapeSelect:e=()=>{}}){super({removeDelay:t,defaultClassName:"toolbar__shape-list"});a(this,"onShapeSelect");this.onShapeSelect=e}mount(t){var o;const e=this.getElement(),s=this.createElement("ul");return Object.entries(L).map(([l,i])=>{const r=this.createElement("li"),m=this.createSVGElement(20,20);m.style.backgroundColor="#EEE",m.style.borderRadius="4px",m.innerHTML=i,m.dataset.shape=l,r.classList.add(`btn-${l}`),r.appendChild(m),s.appendChild(r)}),s.classList.add("wrapper"),e.appendChild(s),s.onclick=l=>{const i=l.target;if(i.closest("li")){const r=i.dataset.shape;r&&this.onShapeSelect({type:r,svg:L[r]})}},(o=document.querySelector(".toolbar"))==null||o.addEventListener("click",l=>{l.target.contains(e)||this.unmount().then(this.onClose)}),super.mount(t)}unMount(){this.unmount()}onClose(){document.body.onclick=null}}class R extends p{constructor(t,e){super(t,e,!0);a(this,"layer")}open(t){if(this.layer=new f(y(E({},t),{removeDelay:0})),this.layer instanceof f)return this.layer.mount(this.target)}close(){if(this.layer instanceof f)return this.layer.unMount()}}class I extends C{constructor({data:t={},status:e="",handlePen:s=()=>{},handleShape:o=()=>{},handleColor:l=()=>{},onClear:i=()=>{}}){super({data:t,defaultClassName:"toolbar"});a(this,"status");a(this,"handlePen");a(this,"handleShape");a(this,"handleColor");a(this,"onClear");this.status=e,this.handlePen=s,this.handleShape=o,this.handleColor=l,this.onClear=i}mount(t){const e=this.getElement(),s=this.createElement("div"),o=this.createElement("span"),l=this.createElement("button"),i=this.createElement("span"),r=this.createElement("span"),m=this.createElement("button"),b=new R(i,{}),D=new N(r,{});return s.classList.add("wrapper"),o.innerText=`[${this.status}]`,o.classList.add("status"),l.innerText="PEN",l.classList.add("btn_pen"),i.innerText="[SHAPE_LIST]",i.classList.add("select_shape"),r.classList.add("palette"),r.innerText="[PALETTE]",m.innerText="CLEAR_ALL",m.classList.add("btn_clear"),s.appendChild(o),s.appendChild(l),s.appendChild(i),s.appendChild(r),s.appendChild(m),e.appendChild(s),l.onclick=this.handlePen,i.onclick=()=>{i.children.length?b.close():b.open({onShapeSelect:S=>this.handleShape(S)})},r.onclick=()=>{r.children.length?D.close():D.open({onColorSelect:S=>this.handleColor(S)})},m.onclick=this.onClear,super.mount(t)}}class U extends p{constructor(n,t){super(n,t)}add(n){return new I(n).mount(this.target)}}c.ModalController=w,c.SelectModalController=_,c.ToastController=O,c.ToolbarController=U,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});